//////////////////////////////////////////////////////////////////////////////////////////////
// DO NOT MODIFY THIS FILE                                                                  //
// This file is automatically generated by ZenStack CLI and should not be manually updated. //
//////////////////////////////////////////////////////////////////////////////////////////////

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id            String         @id() @default(cuid())
  email         String         @unique()
  name          String
  emailVerified Boolean        @default(false)
  image         String?
  role          String         @default("candidate")
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt()
  profile       Profile?
  searchConfigs SearchConfig[]
  offers        Offer[]
  applications  Application[]
  sessions      Session[]
  accounts      Account[]
}

model Profile {
  id               String   @id() @default(cuid())
  userId           String   @unique()
  user             User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  title            String
  phone            String?
  location         String?
  skills           Json     @default("[]")
  softSkills       Json     @default("[]")
  experiences      Json     @default("[]")
  education        Json     @default("[]")
  certifications   Json     @default("[]")
  summary          String?
  linkedinEmail    String?
  linkedinPassword String?
  updatedAt        DateTime @updatedAt()
}

model SearchConfig {
  id              String           @id() @default(cuid())
  userId          String
  user            User             @relation(fields: [userId], references: [id], onDelete: Cascade)
  name            String
  query           String
  location        String
  sites           Json             @default("[\"linkedin\"]")
  remote          Boolean          @default(false)
  salaryMin       Int?
  contractTypes   Json             @default("[\"CDI\"]")
  excludeKeywords Json?
  isActive        Boolean          @default(true)
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt()
  scheduledBy     ScheduleConfig[]
}

model Offer {
  id           String        @id() @default(cuid())
  userId       String
  user         User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  title        String
  company      String
  location     String
  url          String
  description  String
  salary       String?
  contractType String?
  source       String
  isNew        Boolean       @default(true)
  isBookmarked Boolean       @default(false)
  origin       String        @default("sandbox")
  createdAt    DateTime      @default(now())
  applications Application[]

  @@unique([userId, url])
}

model Application {
  id            String   @id() @default(cuid())
  userId        String
  user          User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  offerId       String
  offer         Offer    @relation(fields: [offerId], references: [id], onDelete: Cascade)
  cvContent     String
  letterContent String
  cvPdfUrl      String?
  letterPdfUrl  String?
  status        String   @default("draft")
  notes         String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt()

  @@unique([userId, offerId])
}

model ScheduleConfig {
  id             String        @id() @default(cuid())
  userId         String        @unique()
  hour           Int           @default(8)
  minute         Int           @default(0)
  timezone       String        @default("Europe/Paris")
  isActive       Boolean       @default(false)
  searchConfigId String?
  searchConfig   SearchConfig? @relation(fields: [searchConfigId], references: [id], onDelete: SetNull)
}

model Session {
  id        String   @id()
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  token     String   @unique()
  expiresAt DateTime
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt()
  ipAddress String?
  userAgent String?
}

model Account {
  id                    String    @id()
  userId                String
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  accountId             String
  providerId            String
  accessToken           String?
  refreshToken          String?
  accessTokenExpiresAt  DateTime?
  refreshTokenExpiresAt DateTime?
  scope                 String?
  idToken               String?
  password              String?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt()
}

model Verification {
  id         String   @id()
  identifier String
  value      String
  expiresAt  DateTime
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt()
}
